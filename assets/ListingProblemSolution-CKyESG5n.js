import{r as w,d as _,R as F,j as f,c as k,a as T,b as D,A as L,B as W}from"./index--1uROXG5.js";import{c as N,d as P,a as $,b as B,e as U,P as V,I as H}from"./item-R4MBDgRu.js";function S(r,n,e){let s=e.initialDeps??[],t,i=!0;function o(){var l,a,u;let h;e.key&&((l=e.debug)!=null&&l.call(e))&&(h=Date.now());const d=r();if(!(d.length!==s.length||d.some((p,m)=>s[m]!==p)))return t;s=d;let g;if(e.key&&((a=e.debug)!=null&&a.call(e))&&(g=Date.now()),t=n(...d),e.key&&((u=e.debug)!=null&&u.call(e))){const p=Math.round((Date.now()-h)*100)/100,m=Math.round((Date.now()-g)*100)/100,x=m/16,y=(v,z)=>{for(v=String(v);v.length<z;)v=" "+v;return v};console.info(`%câ± ${y(m,5)} /${y(p,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*x,120))}deg 100% 31%);`,e?.key)}return e?.onChange&&!(i&&e.skipInitialOnChange)&&e.onChange(t),i=!1,t}return o.updateDeps=l=>{s=l},o}function I(r,n){if(r===void 0)throw new Error("Unexpected undefined");return r}const q=(r,n)=>Math.abs(r-n)<1.01,K=(r,n,e)=>{let s;return function(...t){r.clearTimeout(s),s=r.setTimeout(()=>n.apply(this,t),e)}},M=r=>{const{offsetWidth:n,offsetHeight:e}=r;return{width:n,height:e}},G=r=>r,Y=r=>{const n=Math.max(r.startIndex-r.overscan,0),e=Math.min(r.endIndex+r.overscan,r.count-1),s=[];for(let t=n;t<=e;t++)s.push(t);return s},J=(r,n)=>{const e=r.scrollElement;if(!e)return;const s=r.targetWindow;if(!s)return;const t=o=>{const{width:l,height:a}=o;n({width:Math.round(l),height:Math.round(a)})};if(t(M(e)),!s.ResizeObserver)return()=>{};const i=new s.ResizeObserver(o=>{const l=()=>{const a=o[0];if(a?.borderBoxSize){const u=a.borderBoxSize[0];if(u){t({width:u.inlineSize,height:u.blockSize});return}}t(M(e))};r.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(e,{box:"border-box"}),()=>{i.unobserve(e)}},C={passive:!0},O=typeof window>"u"?!0:"onscrollend"in window,Q=(r,n)=>{const e=r.scrollElement;if(!e)return;const s=r.targetWindow;if(!s)return;let t=0;const i=r.options.useScrollendEvent&&O?()=>{}:K(s,()=>{n(t,!1)},r.options.isScrollingResetDelay),o=h=>()=>{const{horizontal:d,isRtl:c}=r.options;t=d?e.scrollLeft*(c&&-1||1):e.scrollTop,i(),n(t,h)},l=o(!0),a=o(!1);a(),e.addEventListener("scroll",l,C);const u=r.options.useScrollendEvent&&O;return u&&e.addEventListener("scrollend",a,C),()=>{e.removeEventListener("scroll",l),u&&e.removeEventListener("scrollend",a)}},X=(r,n,e)=>{if(n?.borderBoxSize){const s=n.borderBoxSize[0];if(s)return Math.round(s[e.options.horizontal?"inlineSize":"blockSize"])}return r[e.options.horizontal?"offsetWidth":"offsetHeight"]},Z=(r,{adjustments:n=0,behavior:e},s)=>{var t,i;const o=r+n;(i=(t=s.scrollElement)==null?void 0:t.scrollTo)==null||i.call(t,{[s.options.horizontal?"left":"top"]:o,behavior:e})};class ee{constructor(n){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const s=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(t=>{t.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var t;(t=s())==null||t.disconnect(),e=null},observe:t=>{var i;return(i=s())==null?void 0:i.observe(t,{box:"border-box"})},unobserve:t=>{var i;return(i=s())==null?void 0:i.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([s,t])=>{typeof t>"u"&&delete e[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:G,rangeExtractor:Y,onChange:()=>{},measureElement:X,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var s,t;(t=(s=this.options).onChange)==null||t.call(s,this,e)},this.maybeNotify=S(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const s=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==s){if(this.cleanup(),!s){this.maybeNotify();return}this.scrollElement=s,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this.elementsCache.forEach(t=>{this.observer.observe(t)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(t,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<t?"forward":"backward":null,this.scrollOffset=t,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,s)=>{const t=new Map,i=new Map;for(let o=s-1;o>=0;o--){const l=e[o];if(t.has(l.lane))continue;const a=i.get(l.lane);if(a==null||l.end>a.end?i.set(l.lane,l):l.end<a.end&&t.set(l.lane,!0),t.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=S(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(e,s,t,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:s,scrollMargin:t,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=S(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:s,scrollMargin:t,getItemKey:i,enabled:o,lanes:l},a)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>e)for(const c of this.laneAssignments.keys())c>=e&&this.laneAssignments.delete(c);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(c=>{this.itemSizeCache.set(c.key,c.size)}));const u=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===e&&(this.lanesSettling=!1);const h=this.measurementsCache.slice(0,u),d=new Array(l).fill(void 0);for(let c=0;c<u;c++){const g=h[c];g&&(d[g.lane]=c)}for(let c=u;c<e;c++){const g=i(c),p=this.laneAssignments.get(c);let m,x;if(p!==void 0&&this.options.lanes>1){m=p;const b=d[m],E=b!==void 0?h[b]:void 0;x=E?E.end+this.options.gap:s+t}else{const b=this.options.lanes===1?h[c-1]:this.getFurthestMeasurement(h,c);x=b?b.end+this.options.gap:s+t,m=b?b.lane:c%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(c,m)}const y=a.get(g),v=typeof y=="number"?y:this.options.estimateSize(c),z=x+v;h[c]={index:c,start:x,size:v,end:z,key:g,lane:m},d[m]=c}return this.measurementsCache=h,h},{key:!1,debug:()=>this.options.debug}),this.calculateRange=S(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,s,t,i)=>this.range=e.length>0&&s>0?te({measurements:e,outerSize:s,scrollOffset:t,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=S(()=>{let e=null,s=null;const t=this.calculateRange();return t&&(e=t.startIndex,s=t.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,s]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,s]},(e,s,t,i,o)=>i===null||o===null?[]:e({startIndex:i,endIndex:o,overscan:s,count:t}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const s=this.options.indexAttribute,t=e.getAttribute(s);return t?parseInt(t,10):(console.warn(`Missing attribute name '${s}={index}' on measured element.`),-1)},this._measureElement=(e,s)=>{const t=this.indexFromElement(e),i=this.measurementsCache[t];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==e&&(l&&this.observer.unobserve(l),this.observer.observe(e),this.elementsCache.set(o,e)),e.isConnected&&this.resizeItem(t,this.options.measureElement(e,s,this))},this.resizeItem=(e,s)=>{const t=this.measurementsCache[e];if(!t)return;const i=this.itemSizeCache.get(t.key)??t.size,o=s-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,o,this):t.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,s)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((s,t)=>{s.isConnected||(this.observer.unobserve(s),this.elementsCache.delete(t))});return}this._measureElement(e,void 0)},this.getVirtualItems=S(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,s)=>{const t=[];for(let i=0,o=e.length;i<o;i++){const l=e[i],a=s[l];t.push(a)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const s=this.getMeasurements();if(s.length!==0)return I(s[j(0,s.length-1,t=>I(s[t]).start,e)])},this.getOffsetForAlignment=(e,s,t=0)=>{const i=this.getSize(),o=this.getScrollOffset();s==="auto"&&(s=e>=o+i?"end":"start"),s==="center"?e+=(t-i)/2:s==="end"&&(e-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,e),0)},this.getOffsetForIndex=(e,s="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=this.measurementsCache[e];if(!t)return;const i=this.getSize(),o=this.getScrollOffset();if(s==="auto")if(t.end>=o+i-this.options.scrollPaddingEnd)s="end";else if(t.start<=o+this.options.scrollPaddingStart)s="start";else return[o,s];const l=s==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,s,t.size),s]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(e,{align:s="start",behavior:t}={})=>{t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,s),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:s="auto",behavior:t}={})=>{t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),e=Math.max(0,Math.min(e,this.options.count-1));let i=0;const o=10,l=u=>{if(!this.targetWindow)return;const h=this.getOffsetForIndex(e,u);if(!h){console.warn("Failed to get offset for index:",e);return}const[d,c]=h;this._scrollToOffset(d,{adjustments:void 0,behavior:t}),this.targetWindow.requestAnimationFrame(()=>{const g=this.getScrollOffset(),p=this.getOffsetForIndex(e,c);if(!p){console.warn("Failed to get offset for index:",e);return}q(p[0],g)||a(c)})},a=u=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(u)):console.warn(`Failed to scroll to index ${e} after ${o} attempts.`))};l(s)},this.scrollBy=(e,{behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:s})},this.getTotalSize=()=>{var e;const s=this.getMeasurements();let t;if(s.length===0)t=this.options.paddingStart;else if(this.options.lanes===1)t=((e=s[s.length-1])==null?void 0:e.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=s.length-1;for(;o>=0&&i.some(l=>l===null);){const l=s[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}t=Math.max(...i.filter(l=>l!==null))}return Math.max(t-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:s,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:s},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(n)}}const j=(r,n,e,s)=>{for(;r<=n;){const t=(r+n)/2|0,i=e(t);if(i<s)r=t+1;else if(i>s)n=t-1;else return t}return r>0?r-1:0};function te({measurements:r,outerSize:n,scrollOffset:e,lanes:s}){const t=r.length-1,i=a=>r[a].start;if(r.length<=s)return{startIndex:0,endIndex:t};let o=j(0,t,i,e),l=o;if(s===1)for(;l<t&&r[l].end<e+n;)l++;else if(s>1){const a=Array(s).fill(0);for(;l<t&&a.some(h=>h<e+n);){const h=r[l];a[h.lane]=h.end,l++}const u=Array(s).fill(e+n);for(;o>=0&&u.some(h=>h>=e);){const h=r[o];u[h.lane]=h.start,o--}o=Math.max(0,o-o%s),l=Math.min(t,l+(s-1-l%s))}return{startIndex:o,endIndex:l}}const A=typeof document<"u"?w.useLayoutEffect:w.useEffect;function se(r){const n=w.useReducer(()=>({}),{})[1],e={...r,onChange:(t,i)=>{var o;i?_.flushSync(n):n(),(o=r.onChange)==null||o.call(r,t,i)}},[s]=w.useState(()=>new ee(e));return s.setOptions(e),A(()=>s._didMount(),[]),A(()=>s._willUpdate()),s}function ne(r){return se({observeElementRect:J,observeElementOffset:Q,scrollToFn:Z,...r})}const R=Array.from({length:1e3},(r,n)=>({id:n,profileImageUrl:`https://i.pravatar.cc/150?u=${n}`,name:`User Name ${n}`,initials:"UN",email:`user${n}@example.com`,lastSeen:`Last seen ${n} minutes ago`})),ie=88,oe=F.memo(r=>{const n=k.c(21),{user:e}=r;let s;n[0]!==e.profileImageUrl?(s=f.jsx(T,{src:e.profileImageUrl}),n[0]=e.profileImageUrl,n[1]=s):s=n[1];let t;n[2]!==e.initials?(t=f.jsx(D,{children:e.initials}),n[2]=e.initials,n[3]=t):t=n[3];let i;n[4]!==s||n[5]!==t?(i=f.jsx($,{children:f.jsxs(L,{className:"size-10",children:[s,t]})}),n[4]=s,n[5]=t,n[6]=i):i=n[6];let o;n[7]!==e.email?(o=f.jsx("sub",{className:"ml-2 text-muted-foreground",children:e.email}),n[7]=e.email,n[8]=o):o=n[8];let l;n[9]!==o||n[10]!==e.name?(l=f.jsxs(N,{children:[e.name,o]}),n[9]=o,n[10]=e.name,n[11]=l):l=n[11];let a;n[12]!==e.lastSeen?(a=f.jsx(P,{children:e.lastSeen}),n[12]=e.lastSeen,n[13]=a):a=n[13];let u;n[14]!==l||n[15]!==a?(u=f.jsxs(B,{children:[l,a]}),n[14]=l,n[15]=a,n[16]=u):u=n[16];let h;n[17]===Symbol.for("react.memo_cache_sentinel")?(h=f.jsx(U,{children:f.jsx(W,{size:"icon-sm",variant:"outline",className:"rounded-full",children:f.jsx(V,{})})}),n[17]=h):h=n[17];let d;return n[18]!==i||n[19]!==u?(d=f.jsxs(H,{variant:"outline",children:[i,u,h]}),n[18]=i,n[19]=u,n[20]=d):d=n[20],d});function ae(){const r=F.useRef(null),n=ne({count:R.length,getScrollElement:()=>r.current,estimateSize:()=>ie,overscan:8,measureElement:e=>e.getBoundingClientRect().height});return f.jsx("div",{ref:r,className:"h-[600px] overflow-auto",children:f.jsx("div",{style:{height:`${n.getTotalSize()}px`,position:"relative"},children:n.getVirtualItems().map(e=>f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${e.start}px)`},children:f.jsx("div",{className:"px-2 py-1",children:f.jsx(oe,{user:R[e.index]})})},e.key))})})}export{ae as default};
